import 'dotenv/config';
import { neon } from '@neondatabase/serverless';

const sql = neon(process.env.DATABASE_URL);

async function fixTables() {
  try {
    console.log('Fixing customers...');
    await sql`ALTER TABLE quickbooks.customers ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY`;
    console.log('✅ customers fixed');
  } catch (e) { console.log('customers:', e.message); }
  
  try {
    console.log('Fixing invoices...');
    await sql`ALTER TABLE quickbooks.invoices ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY`;
    console.log('✅ invoices fixed');
  } catch (e) { console.log('invoices:', e.message); }
  
  try {
    console.log('Fixing estimates...');
    await sql`ALTER TABLE quickbooks.estimates ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY`;
    console.log('✅ estimates fixed');
  } catch (e) { console.log('estimates:', e.message); }
}

fixTables();

